!function(){"use strict";var n="omnisend-forms-tracking-pixels-container",e=function(){return e=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},e.apply(this,arguments)},t=function(n){var t=o(),r=t.shop,i=t.brand,c=t.user,a=t.cookies,u=t.navigation;return function(n){return new URLSearchParams((t=n,Object.keys(t).filter((function(n){return null!==t[n]&&void 0!==t[n]&&""!==t[n]})).reduce((function(n,o){var r;return e(e({},n),((r={})[o]=t[o],r))}),{}))).toString();var t}({timestamp:(new Date).getTime().toString(),shopType:r.getShopType(),shopID:r.getShopID(),shopHostname:r.getShopHostName(),brandID:i.getBrandID(),formID:n,anonymousID:c.getAnonymousID(),sessionID:c.getSessionID(),contactID:a.get("omnisendContactID"),pageTitle:u.getPageTitle(),pageURL:u.getPageUrl()})};function o(){var n=window._omnisend.config.formsAPIHost;return{brand:{getBrandID:function(){var n;return null===(n=window._omnisend.brandSettings)||void 0===n?void 0:n.brandID}},forms:{checkIfWindowIsClear:function(){return window._omnisend.forms.isWindowClear},setWindowClearance:function(n){window._omnisend.forms.isWindowClear=n},getApiHost:function(){return n},getFormsLoadEndpoint:function(e){return"".concat(n,"REST/forms/v1/renderedForms?brandID=").concat(e)},getTrackViewEndpoint:function(e){return"".concat(n,"REST/forms/v1/track/view?").concat(t(e))},getTrackInteractionEndpoint:function(e){return"".concat(n,"REST/forms/v1/track/interaction?").concat(t(e))}},navigation:{redirect:function(n){window.location.href=n},getPageTitle:function(){return window.document.title},getPageUrl:function(){return window.location.href}},cookies:{set:function(n,e,t){var o=(void 0===t?{}:t).expiration,r=void 0===o?365*window._omnisend.cookies.DAY:o;window._omnisend.cookies.set(n,e,r)},get:function(n){return window._omnisend.cookies.get(n)}},shop:{getShopType:function(){return window._omnisend.shopType},getShopID:function(){return window._omnisend.shopID},getShopHostName:function(){return window._omnisend.shopHostname}},user:{getAnonymousID:function(){return window._omnisend.user.anonymousID},getSessionID:function(){return window._omnisend.user.sessionID}}}}var r,i=function(n){return"omnisend-form-".concat(n)},c=function(e){return new Promise((function(t,o){var r=document.createElement("img");r.setAttribute("src",e),r.addEventListener("load",(function(){t(null)})),r.addEventListener("error",(function(){o()})),document.getElementById(n).appendChild(r)}))},a=function(n){return c(o().forms.getTrackInteractionEndpoint(n))},u=function(n){o().cookies.set("".concat(i(n),"-closed-at"),(new Date).toISOString())};!function(n){n.redirect="redirect"}(r||(r={}));var s=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function c(n){try{u(o.next(n))}catch(n){i(n)}}function a(n){try{u(o.throw(n))}catch(n){i(n)}}function u(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(c,a)}u((o=o.apply(n,e||[])).next())}))},l=function(n,e){var t,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(n,c)}catch(n){i=[6,n],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},f=function(n,e,t){void 0===t&&(t=!1),n.addEventListener("click",(function o(){e(),t&&n.removeEventListener("click",o)})),n.addEventListener("keydown",(function o(r){"Enter"!==r.key&&" "!==r.key||(r.preventDefault(),e(),t&&n.removeEventListener("keydown",o))}))},d=function(n,e,t){e&&e.forEach((function(e){var i,c=n.querySelector((i=e.targetID,"#omnisend-form-action-".concat(i)));e.type===r.redirect&&c&&f(c,(function(){return function(n,e){return t=void 0,r=void 0,c=function(){return function(n,e){var t,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(n,c)}catch(n){i=[6,n],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(t){switch(t.label){case 0:return u(e),[4,a(e)];case 1:return t.sent(),o().navigation.redirect(n),[2]}}))},new((i=Promise)||(i=Promise))((function(n,e){function o(n){try{u(c.next(n))}catch(n){e(n)}}function a(n){try{u(c.throw(n))}catch(n){e(n)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(n){n(t)}))).then(o,a)}u((c=c.apply(t,r||[])).next())}));var t,r,i,c}(e.settings.url,t)}))}))};s(void 0,void 0,Promise,(function(){var e,t,r,a,p,m;return l(this,(function(h){switch(h.label){case 0:return e=o(),[4,(v=void 0,w=void 0,y=Promise,b=function(){var n,e,t,r;return function(n,e){var t,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(n,c)}catch(n){i=[6,n],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(i){switch(i.label){case 0:return n=o(),e=n.brand,t=n.forms,(r=e.getBrandID())?[4,fetch(t.getFormsLoadEndpoint(r))]:[2,Promise.resolve([])];case 1:return[2,i.sent().json()]}}))},new(y||(y=Promise))((function(n,e){function t(n){try{r(b.next(n))}catch(n){e(n)}}function o(n){try{r(b.throw(n))}catch(n){e(n)}}function r(e){var r;e.done?n(e.value):(r=e.value,r instanceof y?r:new y((function(n){n(r)}))).then(t,o)}r((b=b.apply(v,w||[])).next())})))];case 1:return(t=h.sent().filter((function(n){return!!n.html}))).length?(r=document.getElementById("omnisend-dynamic-container"),(a=document.createElement("div")).setAttribute("id","omnisend-forms-container"),(p=document.createElement("div")).setAttribute("id",n),r.appendChild(a),r.appendChild(p),m=[],t.forEach((function(n){var e=function(n){var e=document.createElement("div");return e.setAttribute("id",i(n.id)),e.setAttribute("style","display: none"),e.innerHTML=n.html,function(n,e){var t=n.querySelector("#".concat(i(e),"-close-action"));t&&f(t,(function(){return n=e,document.getElementById(i(n)).setAttribute("style","display: none"),o().forms.setWindowClearance(!0),void u(n);var n}),!0)}(e,n.id),d(e,n.actions,n.id),e}(n);a.appendChild(e),m.push({id:n.id,element:e})})),setInterval((function(){o().forms.checkIfWindowIsClear()&&m.filter((function(n){return!!function(n){var e=o(),t=e.cookies,r=e.forms;return!t.get("".concat(n,"-closed-at"))&&r.checkIfWindowIsClear()}(n.element.id)})).forEach((function(n){e.forms.checkIfWindowIsClear()&&function(n){var e=n.id,t=n.element;s(void 0,void 0,void 0,(function(){return l(this,(function(n){var r;return o().forms.setWindowClearance(!1),t.setAttribute("style",""),r=e,c(o().forms.getTrackViewEndpoint(r)),[2]}))}))}(n)}))}),1e3),[2]):[2]}var v,w,y,b}))}))}();
//# sourceMappingURL=main.js.map