!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={server_url:"https://partners.pagefly.io/referral/",routes:{capture:"capture",add:"add"},redirect:{"app-listing":"https://apps.shopify.com/pagefly",upgrade:{"&plan=silver":"https://apps.pagefly.io/shopify/select-plan?plan_id=12","&plan=gold":"https://apps.pagefly.io/shopify/select-plan?plan_id=13","&plan=platinum":"https://apps.pagefly.io/shopify/select-plan?plan_id=14"}}};
/**
 * @version     $Id$
 * @package     PageFly_Affiliate_System
 * @subpackage  Embed
 * @author      PageFly Team <admin@pagefly.io>
 * @copyright   Copyright (C) 2019 PageFly.io. All Rights Reserved.
 * @license     GNU/GPL v2 or later http://www.gnu.org/licenses/gpl-2.0.html
 */const o=r.server_url.split("referral/")[0],i=window.location.href.match(/^([^?]+).*[?&]ref=([^&]+)(&target=([^&]+))?/);function a(t,e,n){const r=document.createElement("form");r.id="pf-as-form",r.action=t,r.method="POST",r.target="pf-as-frame",r.style.display="none",document.body.appendChild(r),Object.keys(e).forEach(t=>{const n=document.createElement("input");n.type="hidden",n.name=t,n.value="object"==typeof e[t]?JSON.stringify(e[t]):e[t],r.appendChild(n)});const o=document.createElement("iframe");o.id="pf-as-frame",o.src="about:blank",o.name="pf-as-frame",o.style.display="none",document.body.appendChild(o),o.onload=r=>{setTimeout(()=>{const r=document.getElementById("pf-as-form");r&&r.parentNode.removeChild(r);const o=document.getElementById("pf-as-frame");if(o&&o.parentNode.removeChild(o),"function"==typeof n){const r=new FormData;Object.keys(e).forEach(t=>{r.append(t,"object"==typeof e[t]?JSON.stringify(e[t]):e[t])}),fetch(t,{method:"POST",body:r}).then(t=>t.json()).then(t=>n(t)).catch(t=>console.warn(t))}},500)},r.submit()}function d(t,e,n,i){const d=e.split("?")[0];let s,l;d.startsWith(o)||(s=document.createElement("style"),s.type="text/css",s.textContent="\n\t\t\t.lds-backdrop {\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tz-index: 9999;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tbackground-color: #fff;\n\t\t\t}\n\t\t\t.lds-ring {\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 80px;\n\t\t\t\theight: 80px;\n\t\t\t}\n\t\t\t.lds-ring div {\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\twidth: 64px;\n\t\t\t\theight: 64px;\n\t\t\t\tmargin: 8px;\n\t\t\t\tborder: 8px solid #000;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tanimation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n\t\t\t\tborder-color: #000 transparent transparent transparent;\n\t\t\t}\n\t\t\t.lds-ring div:nth-child(1) {\n\t\t\t\tanimation-delay: -0.45s;\n\t\t\t}\n\t\t\t.lds-ring div:nth-child(2) {\n\t\t\t\tanimation-delay: -0.3s;\n\t\t\t}\n\t\t\t.lds-ring div:nth-child(3) {\n\t\t\t\tanimation-delay: -0.15s;\n\t\t\t}\n\t\t\t@keyframes lds-ring {\n\t\t\t\t0% {\n\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t}\n\t\t\t\t100% {\n\t\t\t\t\ttransform: rotate(360deg);\n\t\t\t\t}\n\t\t\t}\n\t\t",l=document.createElement("div"),l.className="lds-backdrop",l.innerHTML='<div class="lds-ring"><div></div><div></div><div></div><div></div></div>',document.head.appendChild(s),document.body.appendChild(l)),n=n||document.referrer||"",a(`${r.server_url}${r.routes.capture}`,{ref:t,page:e,from:n},a=>{if(console.log("PF_Affiliate::addReferrer",JSON.parse(JSON.stringify({ref:t,page:e,from:n,res:a}))),a.code&&a.message)return s.parentNode.removeChild(s),void l.parentNode.removeChild(l);if(!d.startsWith(o)){let n;a=a||{partnerType:"content-provider",appStorePartnerId:"",custom_utm:{}};const{partnerType:o,appStorePartnerId:s,custom_utm:l}=a;if(i)if(r.redirect&&r.redirect[i]){if("string"==typeof r.redirect[i])n=`${r.redirect[i]}?utm_source=${l.utm_source||`${o}s`}&utm_medium=${l.utm_medium||("app-provider"===o?s||t:"redirect")}&utm_campaign=${l.utm_campaign||"app-listing"}&utm_content=${l.utm_content||t}&utm_term=${l.utm_term||"pagefly-affiliate"}`;else for(let t in r.redirect[i])if(e.indexOf(t)>-1){n=r.redirect[i][t];break}}else n=`https://apps.shopify.com/pagefly?utm_source=${l.utm_source||`${o}s`}&utm_medium=${l.utm_medium||("app-provider"===o?s||t:"redirect")}&utm_campaign=${l.utm_campaign||"app-listing"}&utm_content=${l.utm_content||t}&utm_term=${l.utm_term||"pagefly-affiliate"}`;else n=`${d}${(l.utm_source||o)&&`?utm_source=${l.utm_source||`${o}s`}&utm_medium=${l.utm_medium||"app-provider"===o&&s||t}&utm_campaign=${l.utm_campaign||"website"}&utm_term=${l.utm_term||"pagefly-affiliate"}`}`;window.location.href=n}})}i&&("complete"===document.readyState||"loading"!==document.readyState&&document.documentElement&&!document.documentElement.doScroll?d(i[2],window.location.href,null,i[4]):document.addEventListener("DOMContentLoaded",()=>d(i[2],window.location.href,null,i[4]))),window.PF_Affiliate=window.PF_Affiliate||{addReferral:function(t,e,n,o,i,d,s,l){a(`${r.server_url}${r.routes.add}`,{shopDomain:t,userEmail:e,userCountry:n,shopifyPlan:o,pageflyPlan:i,chargeAmount:d,billingOn:s},r=>{console.log("PF_Affiliate::addReferral",JSON.parse(JSON.stringify({shopDomain:t,userEmail:e,userCountry:n,shopifyPlan:o,pageflyPlan:i,chargeAmount:d,billingOn:s,res:r}))),"function"==typeof l&&l(r)})},addFormSubmission:function(t,e){a(`${r.server_url}${r.routes.add}`,{type:"form-submission",formData:t},n=>{console.log("PF_Affiliate::addFormSubmission",JSON.parse(JSON.stringify({formData:t,res:n}))),"function"==typeof e&&e(n)})},addUserToUserReferral:function(t,e){a(`${r.server_url}${r.routes.add}`,{type:"user-to-user-referral",shopDomain:t},n=>{console.log("PF_Affiliate::addUserToUserReferral",JSON.parse(JSON.stringify({shopDomain:t,res:n}))),"function"==typeof e&&e(n)})}}}]);